(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1913],{1606:(e,a,l)=>{"use strict";l.r(a),l.d(a,{default:()=>t});var s=l(5155),d=l(1026),n=l(2115);let i=e=>fetch(e).then(e=>e.json());function t(){var e,a,l,t;let[o,c]=(0,n.useState)(!1),{data:r}=(0,d.Ay)("/api/tareas/fichas?page=1&pageSize=1000&sort=alpha",i),{data:u}=(0,d.Ay)("/api/voluntarios",i),{data:m,mutate:p}=(0,d.Ay)("/api/tareas/programa?page=1&pageSize=50",i);async function h(e){e.preventDefault();let a=new FormData(e.currentTarget),l={fichaId:a.get("fichaId"),voluntarioId:a.get("voluntarioId"),ayudanteId:a.get("ayudanteId")||null,asignadoFecha:a.get("asignadoFecha"),completadoFecha:a.get("completadoFecha")||null,notas:a.get("notas")||null};c(!0),await fetch("/api/tareas/programa",{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify(l)}),c(!1),e.currentTarget.reset(),p()}return(0,s.jsxs)("section",{className:"space-y-6",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold",children:"Programa"}),(0,s.jsxs)("form",{onSubmit:h,className:"border rounded p-3 grid gap-3 md:grid-cols-2 bg-white",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm mb-1",children:"Ficha"}),(0,s.jsxs)("select",{name:"fichaId",className:"w-full border rounded px-2 py-1",required:!0,children:[(0,s.jsx)("option",{value:"",children:"Seleccione ficha"}),null==r||null==(e=r.items)?void 0:e.map(e=>(0,s.jsx)("option",{value:e._id||e.id,children:e.titulo},e._id||e.id))]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm mb-1",children:"Supervisor"}),(0,s.jsxs)("select",{name:"voluntarioId",className:"w-full border rounded px-2 py-1",required:!0,children:[(0,s.jsx)("option",{value:"",children:"Seleccione supervisor"}),null==u||null==(a=u.items)?void 0:a.map(e=>(0,s.jsxs)("option",{value:e._id,children:[e.nombre," ",e.apellido]},e._id))]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm mb-1",children:"T\xe9cnico (opcional)"}),(0,s.jsxs)("select",{name:"ayudanteId",className:"w-full border rounded px-2 py-1",children:[(0,s.jsx)("option",{value:"",children:"Sin t\xe9cnico"}),null==u||null==(l=u.items)?void 0:l.map(e=>(0,s.jsxs)("option",{value:e._id,children:[e.nombre," ",e.apellido]},e._id))]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm mb-1",children:"Fecha asignada"}),(0,s.jsx)("input",{type:"date",name:"asignadoFecha",className:"w-full border rounded px-2 py-1",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm mb-1",children:"Fecha completado"}),(0,s.jsx)("input",{type:"date",name:"completadoFecha",className:"w-full border rounded px-2 py-1"})]}),(0,s.jsxs)("div",{className:"md:col-span-2",children:[(0,s.jsx)("label",{className:"block text-sm mb-1",children:"Notas"}),(0,s.jsx)("textarea",{name:"notas",className:"w-full border rounded px-2 py-1 min-h-[100px]"})]}),(0,s.jsx)("div",{className:"md:col-span-2 flex justify-end gap-2",children:(0,s.jsx)("button",{type:"submit",className:"bg-foreground text-background rounded px-3 py-1",disabled:o,children:o?"Guardando...":"Guardar"})})]}),(0,s.jsxs)("div",{className:"border rounded",children:[(0,s.jsx)("div",{className:"px-3 py-2 border-b font-medium bg-neutral-50",children:"Asignaciones"}),(0,s.jsx)("ul",{className:"divide-y",children:null==m||null==(t=m.items)?void 0:t.map(e=>{var a,l,d,n,i;return(0,s.jsxs)("li",{className:"px-3 py-2 text-sm",children:[(0,s.jsx)("div",{className:"font-medium",children:(null==(a=e.fichaId)?void 0:a.titulo)||"(sin ficha)"}),(0,s.jsxs)("div",{className:"text-neutral-600",children:[e.voluntarioId?"".concat(null==(l=e.voluntarioId)?void 0:l.nombre," ").concat(null==(d=e.voluntarioId)?void 0:d.apellido):"(sin supervisor)",e.ayudanteId?" \xb7 T\xe9cnico: ".concat(null==(n=e.ayudanteId)?void 0:n.nombre," ").concat(null==(i=e.ayudanteId)?void 0:i.apellido):""]}),(0,s.jsxs)("div",{className:"text-neutral-500",children:["Asignado: ",new Date(e.asignadoFecha).toLocaleDateString(),e.completadoFecha?" \xb7 Completado: ".concat(new Date(e.completadoFecha).toLocaleDateString()):""]}),e.notas?(0,s.jsx)("div",{className:"text-neutral-600 whitespace-pre-wrap mt-1",children:e.notas}):null]},e._id)})})]})]})}},7776:(e,a,l)=>{Promise.resolve().then(l.bind(l,1606))}},e=>{e.O(0,[1026,8441,1255,7358],()=>e(e.s=7776)),_N_E=e.O()}]);