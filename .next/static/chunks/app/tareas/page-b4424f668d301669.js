(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1861],{1018:(e,a,t)=>{Promise.resolve().then(t.bind(t,4003))},4003:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>d});var s=t(5155),l=t(1026),i=t(2115);let r=i.forwardRef(function(e,a){let{title:t,titleId:s,...l}=e;return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},l),t?i.createElement("title",{id:s},t):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"}))}),n=i.forwardRef(function(e,a){let{title:t,titleId:s,...l}=e;return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},l),t?i.createElement("title",{id:s},t):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m18.375 12.739-7.693 7.693a4.5 4.5 0 0 1-6.364-6.364l10.94-10.94A3 3 0 1 1 19.5 7.372L8.552 18.32m.009-.01-.01.01m5.699-9.941-7.81 7.81a1.5 1.5 0 0 0 2.112 2.13"}))}),c=e=>fetch(e).then(e=>e.json());function d(){var e,a,t,d,o,m;let{data:u}=(0,l.Ay)("/api/tareas/fichas?page=1&pageSize=10000&sort=alpha",c),{data:x,mutate:h}=(0,l.Ay)("/api/tareas/programa?page=1&pageSize=2000",c),{data:p}=(0,l.Ay)("/api/voluntarios",c),[f,v]=(0,i.useState)(""),b=(0,i.useMemo)(()=>(null==u?void 0:u.items)||[],[u]),g=(0,i.useMemo)(()=>(null==x?void 0:x.items)||[],[x]),j=(0,i.useMemo)(()=>Array.isArray(p)?p:(null==p?void 0:p.items)||[],[p]);function N(e){if(!e)return"";try{return new Date(e).toLocaleDateString()}catch(a){return e||""}}let w=(0,i.useMemo)(()=>{let e=new Map,a=[];for(let l of g){var t,s;let i=(null==(t=l.fichaId)?void 0:t._id)||(null==(s=l.fichaId)?void 0:s.id)||"";if(!i){a.push(l);continue}e.has(i)||e.set(i,[]),e.get(i).push(l)}for(let a of e.values())a.sort((e,a)=>new Date(a.completadoFecha||a.asignadoFecha).getTime()-new Date(e.completadoFecha||e.asignadoFecha).getTime());return a.sort((e,a)=>new Date(a.completadoFecha||a.asignadoFecha).getTime()-new Date(e.completadoFecha||e.asignadoFecha).getTime()),{mapa:e,unassigned:a}},[g]),y=(0,i.useMemo)(()=>{let e=f.trim().toLowerCase();return b.filter(a=>!e||(a.titulo||"").toLowerCase().includes(e))},[b,f]),[k,I]=(0,i.useState)(!1),[F,C]=(0,i.useState)(null),[S,_]=(0,i.useState)(!1),[T,D]=(0,i.useState)([]);async function A(e){let a=new FormData;a.append("file",e);let t=await fetch("/api/uploads",{method:"POST",body:a});if(!t.ok)return null;let s=await t.json();return s.thumbId||s.id}async function P(e){if(e.preventDefault(),!F)return;let a=new FormData(e.currentTarget),t={fichaId:F._id||F.id,voluntarioId:a.get("voluntarioId"),ayudanteId:a.get("ayudanteId")||null,asignadoFecha:a.get("asignadoFecha"),notas:a.get("notas")||null,fotos:T};_(!0),await fetch("/api/tareas/programa",{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify(t)}),_(!1),I(!1),C(null),D([]),h()}let[O,E]=(0,i.useState)(!1),[V,q]=(0,i.useState)(null),[L,M]=(0,i.useState)([]);function z(e){q(e),M(e.fotos||[]),E(!0)}async function B(e){var a,t;if(e.preventDefault(),!V)return;let s=new FormData(e.currentTarget),l={voluntarioId:s.get("voluntarioId")||(null==(a=V.voluntarioId)?void 0:a._id)||(null==(t=V.voluntarioId)?void 0:t.id),ayudanteId:s.get("ayudanteId")||"",completadoFecha:s.get("completadoFecha")||null,notas:s.get("notas")||null,fotos:L};await fetch("/api/tareas/programa/".concat(V._id),{method:"PATCH",headers:{"content-type":"application/json"},body:JSON.stringify(l)}),E(!1),q(null),h()}let{data:G}=(0,l.Ay)("/api/proyectos?page=1&pageSize=1000",c),J=(0,i.useMemo)(()=>(null==G?void 0:G.items)||[],[G]),[H,R]=(0,i.useState)(!1),[W,K]=(0,i.useState)(!1),[Q,U]=(0,i.useState)([]),[X,Y]=(0,i.useState)(!1),[Z,$]=(0,i.useState)({});async function ee(e){let a=new FormData;a.append("file",e);let t=await fetch("/api/uploads",{method:"POST",body:a});if(!t.ok)return null;let s=await t.json();return s.thumbId||s.id}async function ea(e){U(a=>a.filter(a=>a!==e))}async function et(e){e.preventDefault();let a=new FormData(e.currentTarget),t=a.get("projectId"),s=String(a.get("newProjectTitle")||"").trim();K(!0);try{let e=t||null;if(X&&s){let a=await fetch("/api/proyectos",{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({titulo:s})});if(!a.ok)throw Error(await a.text());let t=await a.json();e=t._id||t.id||null}let l={fichaId:null,voluntarioId:a.get("voluntarioId")||void 0,ayudanteId:a.get("ayudanteId")||void 0,asignadoFecha:a.get("asignadoFecha")||null,notas:a.get("notas")||null,fotos:Q,titulo:String(a.get("titulo")||"").trim(),inicio:a.get("startDate")||null,fin:a.get("endDate")||null},i={};if(l.titulo||(i.titulo="El t\xedtulo es obligatorio"),l.voluntarioId||(i.voluntarioId="Selecciona el supervisor asignado"),l.asignadoFecha||(i.asignadoFecha="Selecciona la fecha de asignaci\xf3n"),X&&!s&&(i.newProjectTitle="Debe indicar el t\xedtulo del nuevo proyecto"),Object.keys(i).length>0){$(i);let e=Object.keys(i)[0],a=document.querySelector('[name="'.concat(e,'"]'));a&&"function"==typeof a.focus&&a.focus(),K(!1);return}$({});let r=await fetch("/api/tareas/programa",{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify(l)});if(!r.ok)throw Error(await r.text());let n=await r.json();if(e){let t=await fetch("/api/proyectos/".concat(e));if(t.ok){let s=await t.json(),i=Array.isArray(s.weeklyTasks)?s.weeklyTasks:[],r={weekStart:a.get("asignadoFecha")?new Date(String(a.get("asignadoFecha"))):new Date,title:l.titulo,description:l.notas||"",assigneeId:l.voluntarioId,status:"todo",startDate:l.inicio?new Date(String(l.inicio)):null,endDate:l.fin?new Date(String(l.fin)):null,programaId:n._id||n.id||null},c=await fetch("/api/proyectos/".concat(e),{method:"PATCH",headers:{"content-type":"application/json"},body:JSON.stringify({weeklyTasks:[...i,r]})});c.ok||console.warn("No se pudo agregar la tarea al proyecto:",await c.text())}}U([]),R(!1),$({}),h(),alert("Tarea creada correctamente")}catch(e){alert("Error creando tarea: ".concat((null==e?void 0:e.message)||e))}finally{K(!1)}}return(0,s.jsxs)("section",{className:"space-y-4",children:[(0,s.jsx)("div",{className:"sticky top-0 z-40 bg-[color:var(--surface)]/90 backdrop-blur border-b",children:(0,s.jsx)("div",{className:"flex items-center justify-between px-3 py-2",children:(0,s.jsx)("div",{className:"flex items-center gap-2 text-sm overflow-x-auto whitespace-nowrap -mx-1 px-1",children:(0,s.jsx)("span",{className:"px-3 py-1 rounded border bg-white/5",children:"Tareas"})})})}),(0,s.jsx)("h1",{className:"text-2xl font-bold",children:"Tareas"}),(0,s.jsx)("div",{children:(0,s.jsx)("input",{className:"w-full input",placeholder:"Buscar...",value:f,onChange:e=>v(e.target.value)})}),(0,s.jsxs)("div",{className:"space-y-6",children:[y.map(e=>{let a=e._id||e.id||"",t=w.mapa.get(String(a))||[];return(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,s.jsx)("div",{className:"font-semibold uppercase tracking-wide",children:e.titulo}),(0,s.jsxs)("button",{className:"inline-flex items-center gap-2 btn",onClick:()=>{C(e),I(!0)},children:[(0,s.jsx)(r,{className:"w-5 h-5"})," Agregar nuevo"]})]}),0===t.length?(0,s.jsx)("div",{className:"text-sm text-[color:var(--muted)]",children:"Sin registros."}):(0,s.jsx)("div",{className:"grid gap-3 sm:grid-cols-2 lg:grid-cols-3",children:t.map(e=>{var a,t,l,i,r;let c=!!e.completadoFecha,d=!!(null==(a=e.fichaId)?void 0:a.pdfId);return(0,s.jsxs)("div",{className:"card overflow-hidden cursor-pointer",onClick:()=>z(e),children:[(0,s.jsxs)("div",{className:"px-3 py-2 text-sm flex items-start justify-between bg-[color:var(--surface-2)] border-b border-[color:var(--border)]",children:[(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)("div",{className:"font-medium truncate",children:e.voluntarioId?"".concat(null==(t=e.voluntarioId)?void 0:t.nombre," ").concat(null==(l=e.voluntarioId)?void 0:l.apellido):"(sin supervisor)"}),(0,s.jsxs)("div",{className:"text-xs text-[color:var(--muted)] truncate",children:["T\xe9cnico ",e.ayudanteId?"\xb7 ".concat(null==(i=e.ayudanteId)?void 0:i.nombre," ").concat(null==(r=e.ayudanteId)?void 0:r.apellido):"(ninguno)"]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2 ml-2",children:[d&&(0,s.jsxs)("a",{href:"/api/tareas/fichas/file/".concat(e.fichaId.pdfId),target:"_blank",rel:"noreferrer",onClick:e=>e.stopPropagation(),title:"Ver adjunto de la ficha",className:"inline-flex items-center gap-1 text-xs font-medium px-2 py-0.5 rounded border bg-[color:var(--surface)] hover:bg-white/5",children:[(0,s.jsx)(n,{className:"w-4 h-4"}),"Adjunto"]}),(0,s.jsx)("span",{className:"badge ".concat(c?"badge-success":"badge-warning"),children:c?"Completo":"Pendiente"})]})]}),(0,s.jsxs)("div",{className:"px-3 py-3 text-sm",children:[(0,s.jsx)("div",{className:"font-semibold flex items-center gap-2",children:c?"Fecha que se complet\xf3":"Debe cumplir con la asignaci\xf3n para"}),(0,s.jsx)("div",{className:"mb-2 text-lg font-bold",children:N(e.completadoFecha||e.asignadoFecha)}),e.notas?(0,s.jsx)("div",{className:"text-[color:var(--foreground)]/90 whitespace-pre-wrap",style:{wordBreak:"break-word"},children:e.notas}):null,Array.isArray(e.fotos)&&e.fotos.length?(0,s.jsx)("div",{className:"mt-2 flex flex-wrap gap-2",children:e.fotos.slice(0,6).map(e=>(0,s.jsx)("div",{className:"w-12 h-12 border rounded overflow-hidden bg-[color:var(--surface-2)]",children:(0,s.jsx)("img",{src:"/api/images/".concat(e,"?thumb=1"),alt:"foto",className:"w-full h-full object-cover"})},e))}):null,(0,s.jsxs)("div",{className:"mt-2 text-xs text-[color:var(--muted)]",children:["Click para ",c?"editar":"marcar como completo"]})]})]},e._id)})})]},String(a))}),w.unassigned&&w.unassigned.length>0&&(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,s.jsx)("div",{className:"font-semibold uppercase tracking-wide",children:"Generales"}),(0,s.jsx)("div",{})]}),(0,s.jsx)("div",{className:"grid gap-3 sm:grid-cols-2 lg:grid-cols-3",children:w.unassigned.map(e=>{var a,t,l,i,r;let c=!!e.completadoFecha,d=!!(null==(a=e.fichaId)?void 0:a.pdfId);return(0,s.jsxs)("div",{className:"card overflow-hidden cursor-pointer",onClick:()=>z(e),children:[(0,s.jsxs)("div",{className:"px-3 py-2 text-sm flex items-start justify-between bg-[color:var(--surface-2)] border-b border-[color:var(--border)]",children:[(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)("div",{className:"font-medium truncate",children:e.voluntarioId?"".concat(null==(t=e.voluntarioId)?void 0:t.nombre," ").concat(null==(l=e.voluntarioId)?void 0:l.apellido):"(sin supervisor)"}),(0,s.jsxs)("div",{className:"text-xs text-[color:var(--muted)] truncate",children:["T\xe9cnico ",e.ayudanteId?"\xb7 ".concat(null==(i=e.ayudanteId)?void 0:i.nombre," ").concat(null==(r=e.ayudanteId)?void 0:r.apellido):"(ninguno)"]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2 ml-2",children:[d&&(0,s.jsxs)("a",{href:"/api/tareas/fichas/file/".concat(e.fichaId.pdfId),target:"_blank",rel:"noreferrer",onClick:e=>e.stopPropagation(),title:"Ver adjunto de la ficha",className:"inline-flex items-center gap-1 text-xs font-medium px-2 py-0.5 rounded border bg-[color:var(--surface)] hover:bg-white/5",children:[(0,s.jsx)(n,{className:"w-4 h-4"}),"Adjunto"]}),(0,s.jsx)("span",{className:"badge ".concat(c?"badge-success":"badge-warning"),children:c?"Completo":"Pendiente"})]})]}),(0,s.jsxs)("div",{className:"px-3 py-3 text-sm",children:[(0,s.jsx)("div",{className:"font-semibold flex items-center gap-2",children:c?"Fecha que se complet\xf3":"Debe cumplir con la asignaci\xf3n para"}),(0,s.jsx)("div",{className:"mb-2 text-lg font-bold",children:N(e.completadoFecha||e.asignadoFecha)}),e.notas?(0,s.jsx)("div",{className:"text-[color:var(--foreground)]/90 whitespace-pre-wrap",style:{wordBreak:"break-word"},children:e.notas}):null,Array.isArray(e.fotos)&&e.fotos.length?(0,s.jsx)("div",{className:"mt-2 flex flex-wrap gap-2",children:e.fotos.slice(0,6).map(e=>(0,s.jsx)("div",{className:"w-12 h-12 border rounded overflow-hidden bg-[color:var(--surface-2)]",children:(0,s.jsx)("img",{src:"/api/images/".concat(e,"?thumb=1"),alt:"foto",className:"w-full h-full object-cover"})},e))}):null,(0,s.jsxs)("div",{className:"mt-2 text-xs text-[color:var(--muted)]",children:["Click para ",c?"editar":"marcar como completo"]})]})]},e._id)})})]},"__sin-ficha")]}),k&&F&&(0,s.jsxs)("div",{className:"fixed inset-0 z-50",children:[(0,s.jsx)("div",{className:"absolute inset-0 bg-black/60",onClick:()=>I(!1)}),(0,s.jsx)("div",{className:"absolute inset-0 flex items-center justify-center p-4",children:(0,s.jsxs)("div",{className:"card w-[95vw] max-w-3xl max-h-[90vh] overflow-hidden flex flex-col",children:[(0,s.jsxs)("div",{className:"px-4 py-3 card-header flex items-center gap-2",children:[(0,s.jsx)("div",{className:"font-semibold",children:"Nuevo registro"}),(0,s.jsx)("button",{className:"ml-auto btn btn-ghost",onClick:()=>I(!1),"aria-label":"Cerrar",children:"Cerrar"})]}),(0,s.jsxs)("form",{onSubmit:P,className:"flex-1 overflow-auto p-4",children:[F.pdfId?(0,s.jsxs)("div",{className:"mb-4 border rounded bg-[color:var(--surface-2)] p-3 flex items-center gap-3",children:[(0,s.jsx)("div",{className:"text-sm font-medium",children:"Archivo de ficha:"}),(0,s.jsx)("a",{className:"text-blue-400 underline text-sm",href:"/api/tareas/fichas/file/".concat(F.pdfId),target:"_blank",rel:"noreferrer",children:"Abrir"}),(0,s.jsx)("a",{className:"text-blue-400 underline text-sm",href:"/api/tareas/fichas/file/".concat(F.pdfId),download:!0,children:"Descargar"})]}):null,(0,s.jsxs)("div",{className:"grid gap-3 sm:grid-cols-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm mb-1",children:"Asignado a (Supervisor)"}),(0,s.jsxs)("select",{name:"voluntarioId",className:"select",required:!0,defaultValue:"",children:[(0,s.jsx)("option",{value:"",disabled:!0,children:"No seleccionado"}),j.map(e=>(0,s.jsxs)("option",{value:e._id||e.id,children:[e.nombre," ",e.apellido]},e._id||e.id))]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm mb-1",children:"T\xe9cnico"}),(0,s.jsxs)("select",{name:"ayudanteId",className:"select",defaultValue:"",children:[(0,s.jsx)("option",{value:"",children:"No seleccionado"}),j.map(e=>(0,s.jsxs)("option",{value:e._id||e.id,children:[e.nombre," ",e.apellido]},e._id||e.id))]})]})]}),(0,s.jsxs)("div",{className:"mt-4",children:[(0,s.jsx)("div",{className:"text-sm",children:"Debe cumplir con la asignaci\xf3n para"}),(0,s.jsx)("input",{type:"date",name:"asignadoFecha",className:"input mt-1",required:!0})]}),(0,s.jsxs)("div",{className:"mt-4",children:[(0,s.jsx)("div",{className:"text-sm mb-1",children:"Notas"}),(0,s.jsx)("textarea",{name:"notas",className:"w-full textarea min-h-[120px]"})]}),(0,s.jsxs)("div",{className:"mt-4",children:[(0,s.jsx)("div",{className:"text-sm mb-1",children:"Fotos"}),(0,s.jsx)("div",{className:"flex flex-wrap gap-2 mb-2",children:T.map(e=>(0,s.jsxs)("div",{className:"relative w-20 h-20 border rounded overflow-hidden bg-[color:var(--surface-2)]",children:[(0,s.jsx)("img",{src:"/api/images/".concat(e),alt:"foto",className:"w-full h-full object-cover"}),(0,s.jsx)("button",{type:"button",className:"absolute top-0 right-0 bg-black/60 text-white text-xs px-1",onClick:()=>{D(a=>a.filter(a=>a!==e))},children:"x"})]},e))}),(0,s.jsx)("input",{type:"file",accept:"image/*",onChange:async e=>{var a;let t=null==(a=e.target.files)?void 0:a[0];if(!t)return;let s=await A(t);s&&D(e=>[...e,s]),e.currentTarget.value=""}})]}),(0,s.jsxs)("div",{className:"px-0 pt-3 mt-4 border-t flex items-center gap-2 justify-end",children:[(0,s.jsx)("button",{className:"btn btn-primary disabled:opacity-50",disabled:S,type:"submit",children:S?"Guardando...":"Guardar"}),(0,s.jsx)("button",{type:"button",className:"btn",onClick:()=>I(!1),children:"Cancelar"})]})]})]})})]}),O&&V&&(0,s.jsxs)("div",{className:"fixed inset-0 z-50",children:[(0,s.jsx)("div",{className:"absolute inset-0 bg-black/60",onClick:()=>E(!1)}),(0,s.jsx)("div",{className:"absolute inset-0 flex items-center justify-center p-4",children:(0,s.jsxs)("div",{className:"card w-[95vw] max-w-3xl max-h-[90vh] overflow-hidden flex flex-col",children:[(0,s.jsxs)("div",{className:"px-4 py-3 card-header flex items-center gap-2",children:[(0,s.jsx)("div",{className:"text-lg font-semibold uppercase",children:((null==(e=V.fichaId)?void 0:e.titulo)||"").toString()}),(0,s.jsx)("button",{className:"ml-auto btn btn-ghost",onClick:()=>E(!1),"aria-label":"Cerrar",children:"Cerrar"})]}),(0,s.jsxs)("form",{onSubmit:B,className:"p-4 space-y-4 overflow-auto",children:[(null==(a=V.fichaId)?void 0:a.pdfId)?(0,s.jsxs)("div",{className:"border rounded bg-[color:var(--surface-2)] p-3 flex items-center gap-3",children:[(0,s.jsx)("div",{className:"text-sm font-medium",children:"Archivo de ficha:"}),(0,s.jsx)("a",{className:"text-blue-400 underline text-sm",href:"/api/tareas/fichas/file/".concat(V.fichaId.pdfId),target:"_blank",rel:"noreferrer",children:"Abrir"}),(0,s.jsx)("a",{className:"text-blue-400 underline text-sm",href:"/api/tareas/fichas/file/".concat(V.fichaId.pdfId),download:!0,children:"Descargar"})]}):null,(0,s.jsxs)("div",{className:"grid gap-3 sm:grid-cols-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm mb-1",children:"Asignado a (Supervisor)"}),(0,s.jsxs)("select",{name:"voluntarioId",className:"w-full border rounded px-2 py-1",defaultValue:(null==(t=V.voluntarioId)?void 0:t._id)||(null==(d=V.voluntarioId)?void 0:d.id)||"",required:!0,children:[(0,s.jsx)("option",{value:"",disabled:!0,children:"No seleccionado"}),j.map(e=>(0,s.jsxs)("option",{value:e._id||e.id,children:[e.nombre," ",e.apellido]},e._id||e.id))]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm mb-1",children:"T\xe9cnico"}),(0,s.jsxs)("select",{name:"ayudanteId",className:"w-full border rounded px-2 py-1",defaultValue:(null==(o=V.ayudanteId)?void 0:o._id)||(null==(m=V.ayudanteId)?void 0:m.id)||"",children:[(0,s.jsx)("option",{value:"",children:"No seleccionado"}),j.map(e=>(0,s.jsxs)("option",{value:e._id||e.id,children:[e.nombre," ",e.apellido]},e._id||e.id))]})]})]}),(0,s.jsxs)("div",{className:"grid gap-3 sm:grid-cols-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm text-neutral-800",children:"Fecha en que se asign\xf3"}),(0,s.jsx)("div",{className:"text-base font-medium mt-1",children:N(V.createdAt||V.asignadoFecha)})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm text-neutral-800",children:"Debe cumplir con la asignaci\xf3n para"}),(0,s.jsx)("div",{className:"text-2xl font-bold mt-1",children:N(V.asignadoFecha)})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm text-neutral-800",children:"Fecha que se complet\xf3"}),(0,s.jsx)("input",{type:"date",name:"completadoFecha",className:"border rounded px-2 py-1 mt-1",defaultValue:V.completadoFecha?String(V.completadoFecha).slice(0,10):""})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm text-neutral-800 mb-1",children:"Notas"}),(0,s.jsx)("textarea",{name:"notas",className:"w-full border rounded px-3 py-2 min-h-[100px]",defaultValue:V.notas||""})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm text-neutral-800 mb-1",children:"Fotos"}),(0,s.jsx)("div",{className:"flex flex-wrap gap-2 mb-2",children:L.map(e=>(0,s.jsxs)("div",{className:"relative w-20 h-20 border rounded overflow-hidden",children:[(0,s.jsx)("img",{src:"/api/images/".concat(e),alt:"foto",className:"w-full h-full object-cover"}),(0,s.jsx)("button",{type:"button",className:"absolute top-0 right-0 bg-black/60 text-white text-xs px-1",onClick:()=>{M(a=>a.filter(a=>a!==e))},children:"x"})]},e))}),(0,s.jsx)("input",{type:"file",accept:"image/*",onChange:async e=>{var a;let t=null==(a=e.target.files)?void 0:a[0];if(!t)return;let s=await A(t);s&&M(e=>[...e,s]),e.currentTarget.value=""}})]}),(0,s.jsxs)("div",{className:"pt-3 border-t flex items-center justify-end gap-2",children:[(0,s.jsx)("button",{type:"submit",className:"btn btn-primary",children:"Guardar"}),(0,s.jsx)("button",{type:"button",className:"btn",onClick:()=>E(!1),children:"Cancelar"})]})]})]})})]}),(0,s.jsx)("div",{className:"flex gap-2",children:(0,s.jsx)("button",{className:"btn btn-primary",onClick:()=>R(!0),children:"➕ Nueva tarea"})}),H&&(0,s.jsxs)("div",{className:"fixed inset-0 z-50",children:[(0,s.jsx)("div",{className:"absolute inset-0 bg-black/60",onClick:()=>R(!1)}),(0,s.jsx)("div",{className:"absolute inset-0 flex items-center justify-center p-4",children:(0,s.jsxs)("div",{className:"card w-[95vw] max-w-3xl max-h-[90vh] overflow-hidden flex flex-col",children:[(0,s.jsxs)("div",{className:"px-4 py-3 card-header flex items-center gap-2",children:[(0,s.jsx)("div",{className:"font-semibold",children:"Crear nueva tarea"}),(0,s.jsx)("button",{className:"ml-auto btn btn-ghost",onClick:()=>R(!1),"aria-label":"Cerrar",children:"Cerrar"})]}),(0,s.jsxs)("form",{onSubmit:et,className:"flex-1 overflow-auto p-4 space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm mb-1",children:"T\xedtulo de la tarea *"}),(0,s.jsx)("input",{name:"titulo",className:"w-full input ".concat(Z.titulo?"border-red-500 ring-1 ring-red-300":"")}),Z.titulo&&(0,s.jsx)("div",{className:"text-sm text-red-500 mt-1",children:Z.titulo})]}),(0,s.jsxs)("div",{className:"grid gap-3 sm:grid-cols-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm mb-1",children:"Asignado a (Supervisor) *"}),(0,s.jsxs)("select",{name:"voluntarioId",className:"select ".concat(Z.voluntarioId?"border-red-500 ring-1 ring-red-300":""),defaultValue:"",children:[(0,s.jsx)("option",{value:"",disabled:!0,children:"No seleccionado"}),j.map(e=>(0,s.jsxs)("option",{value:e._id||e.id,children:[e.nombre," ",e.apellido]},e._id||e.id))]}),Z.voluntarioId&&(0,s.jsx)("div",{className:"text-sm text-red-500 mt-1",children:Z.voluntarioId})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm mb-1",children:"T\xe9cnico"}),(0,s.jsxs)("select",{name:"ayudanteId",className:"select",defaultValue:"",children:[(0,s.jsx)("option",{value:"",children:"No seleccionado"}),j.map(e=>(0,s.jsxs)("option",{value:e._id||e.id,children:[e.nombre," ",e.apellido]},e._id||e.id))]})]})]}),(0,s.jsxs)("div",{className:"grid gap-3 sm:grid-cols-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-sm",children:"Fecha de asignaci\xf3n *"}),(0,s.jsx)("input",{type:"date",name:"asignadoFecha",className:"input mt-1 ".concat(Z.asignadoFecha?"border-red-500 ring-1 ring-red-300":"")}),Z.asignadoFecha&&(0,s.jsx)("div",{className:"text-sm text-red-500 mt-1",children:Z.asignadoFecha})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-sm",children:"Fecha inicio"}),(0,s.jsx)("input",{type:"date",name:"startDate",className:"input mt-1"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-sm",children:"Fecha fin"}),(0,s.jsx)("input",{type:"date",name:"endDate",className:"input mt-1"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm mb-1",children:"Notas"}),(0,s.jsx)("textarea",{name:"notas",className:"w-full textarea min-h-[120px]"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm mb-1",children:"Proyecto (opcional)"}),(0,s.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,s.jsxs)("select",{name:"projectId",className:"select flex-1",defaultValue:"",children:[(0,s.jsx)("option",{value:"",children:"No vinculado"}),J.map(e=>(0,s.jsx)("option",{value:e._id,children:e.titulo},e._id))]}),(0,s.jsxs)("label",{className:"flex items-center gap-2 text-sm",children:[(0,s.jsx)("input",{type:"checkbox",checked:X,onChange:e=>Y(e.target.checked)})," Crear proyecto nuevo"]})]}),X&&(0,s.jsxs)("div",{className:"mt-2",children:[(0,s.jsx)("input",{name:"newProjectTitle",className:"w-full input ".concat(Z.newProjectTitle?"border-red-500 ring-1 ring-red-300":""),placeholder:"T\xedtulo del nuevo proyecto"}),Z.newProjectTitle&&(0,s.jsx)("div",{className:"text-sm text-red-500 mt-1",children:Z.newProjectTitle})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm mb-1",children:"Fotos de apoyo"}),(0,s.jsx)("div",{className:"flex flex-wrap gap-2 mb-2",children:Q.map(e=>(0,s.jsxs)("div",{className:"relative w-20 h-20 border rounded overflow-hidden bg-[color:var(--surface-2)]",children:[(0,s.jsx)("img",{src:"/api/images/".concat(e),alt:"foto",className:"w-full h-full object-cover"}),(0,s.jsx)("button",{type:"button",className:"absolute top-0 right-0 bg-black/60 text-white text-xs px-1",onClick:()=>ea(e),children:"x"})]},e))}),(0,s.jsx)("input",{type:"file",accept:"image/*",onChange:async e=>{var a;let t=null==(a=e.target.files)?void 0:a[0];if(!t)return;let s=await ee(t);s&&U(e=>[...e,s]),e.currentTarget.value=""}})]}),(0,s.jsxs)("div",{className:"text-right",children:[(0,s.jsx)("button",{type:"submit",className:"btn btn-primary",disabled:W,children:W?"Guardando...":"Crear tarea"}),(0,s.jsx)("button",{type:"button",className:"btn ml-2",onClick:()=>R(!1),children:"Cancelar"})]})]})]})})]})]})}}},e=>{e.O(0,[1026,8441,1255,7358],()=>e(e.s=1018)),_N_E=e.O()}]);