(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2099],{217:(e,a,l)=>{"use strict";l.r(a),l.d(a,{default:()=>u});var s=l(5155),t=l(1026),n=l(2115);let r=n.forwardRef(function(e,a){let{title:l,titleId:s,...t}=e;return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},t),l?n.createElement("title",{id:s},l):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v6m3-3H9m12 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}),i=n.forwardRef(function(e,a){let{title:l,titleId:s,...t}=e;return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},t),l?n.createElement("title",{id:s},l):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"}))}),o=n.forwardRef(function(e,a){let{title:l,titleId:s,...t}=e;return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":s},t),l?n.createElement("title",{id:s},l):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"}))});var c=l(2619),d=l.n(c);let m=async e=>{let a=await fetch(e,{credentials:"include"}),l=null;try{l=await a.json()}catch(e){}return{ok:a.ok,status:a.status,data:l}};function u(){let{data:e,mutate:a}=(0,t.Ay)("/api/voluntarios",m),l=Array.isArray(null==e?void 0:e.data)?e.data:[],c=e&&401===e.status,[u,x]=(0,n.useState)({nombre:"",apellido:"",email:"",telefono:"",congregacion:"",empresa:"",cargo:"Tecnico"}),[h,p]=(0,n.useState)(!1),[b,j]=(0,n.useState)(!1),[v,g]=(0,n.useState)(null),[f,N]=(0,n.useState)({});async function w(e){e.preventDefault();let l={...u};l.empresa&&(l.congregacion=l.empresa);let s=await fetch("/api/voluntarios",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)});if(s.ok)x({nombre:"",apellido:"",email:"",telefono:"",congregacion:"",empresa:"",cargo:"Tecnico"}),p(!1),a();else{let e=await s.json().catch(()=>({}));409===s.status?alert((null==e?void 0:e.error)||"El voluntario ya existe"):alert((null==e?void 0:e.error)||"Error guardando")}}async function y(e){g(e.id),N({nombre:e.nombre,apellido:e.apellido,email:e.email||"",telefono:e.telefono||"",congregacion:e.congregacion||"",empresa:e.empresa||e.congregacion||"",cargo:e.cargo||"Tecnico"}),j(!0)}async function C(e){if(e&&e.preventDefault(),!v)return;let l={...f};l.empresa&&(l.congregacion=l.empresa),await fetch("/api/voluntarios/".concat(v),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)}),g(null),N({}),j(!1),a()}async function k(e){confirm("\xbfEliminar empleado?")&&(await fetch("/api/voluntarios/".concat(e),{method:"DELETE"}),a())}return(0,s.jsxs)("div",{className:"max-w-6xl mx-auto p-6 space-y-8",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold",children:"Empleados"}),(0,s.jsxs)("button",{className:"inline-flex items-center gap-2 px-3 py-2 rounded bg-foreground text-background",onClick:()=>p(!0),"aria-label":"Nuevo empleado",children:[(0,s.jsx)(r,{className:"h-5 w-5"}),(0,s.jsx)("span",{children:"Nuevo"})]})]}),c?(0,s.jsxs)("div",{className:"p-4 rounded border bg-yellow-50 text-yellow-800",children:["Necesitas iniciar sesi\xf3n para ver esta secci\xf3n. "," ",(0,s.jsx)(d(),{href:"/signin",className:"underline",children:"Ir a iniciar sesi\xf3n"})]}):null,h&&(0,s.jsxs)("div",{className:"fixed inset-0 z-50",role:"dialog","aria-modal":"true",children:[(0,s.jsx)("div",{className:"absolute inset-0 bg-black/60",onClick:()=>p(!1)}),(0,s.jsx)("div",{className:"absolute inset-0 flex items-center justify-center p-4",children:(0,s.jsxs)("div",{className:"card w-[95vw] max-w-3xl max-h-[85vh] overflow-auto",children:[(0,s.jsxs)("div",{className:"px-4 py-3 card-header flex items-center gap-2",children:[(0,s.jsx)("div",{className:"font-semibold",children:"Nuevo empleado"}),(0,s.jsx)("button",{className:"ml-auto btn btn-ghost",onClick:()=>p(!1),children:"Cerrar"})]}),(0,s.jsxs)("form",{onSubmit:w,className:"p-4 grid gap-4 sm:grid-cols-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm mb-1",children:"Nombre"}),(0,s.jsx)("input",{className:"w-full input",value:u.nombre,onChange:e=>x({...u,nombre:e.target.value}),required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm mb-1",children:"Apellido"}),(0,s.jsx)("input",{className:"w-full input",value:u.apellido,onChange:e=>x({...u,apellido:e.target.value}),required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm mb-1",children:"Correo"}),(0,s.jsx)("input",{className:"w-full input",type:"email",value:u.email,onChange:e=>x({...u,email:e.target.value})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm mb-1",children:"Tel\xe9fono"}),(0,s.jsx)("input",{className:"w-full input",value:u.telefono,onChange:e=>x({...u,telefono:e.target.value})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm mb-1",children:"Empresa"}),(0,s.jsx)("input",{className:"w-full input",value:u.empresa,onChange:e=>x({...u,empresa:e.target.value})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm mb-1",children:"Cargo"}),(0,s.jsxs)("select",{className:"w-full input",value:u.cargo,onChange:e=>x({...u,cargo:e.target.value}),children:[(0,s.jsx)("option",{value:"Supervisor",children:"Supervisor"}),(0,s.jsx)("option",{value:"Tecnico",children:"Tecnico"}),(0,s.jsx)("option",{value:"Contratista",children:"Contratista"})]})]}),(0,s.jsxs)("div",{className:"sm:col-span-2 flex items-center gap-3 pt-2 justify-end",children:[(0,s.jsx)("button",{type:"button",className:"btn",onClick:()=>p(!1),children:"Cancelar"}),(0,s.jsx)("button",{type:"submit",className:"btn btn-primary",children:"Guardar"})]})]})]})})]}),b&&(0,s.jsxs)("div",{className:"fixed inset-0 z-50",role:"dialog","aria-modal":"true",children:[(0,s.jsx)("div",{className:"absolute inset-0 bg-black/60",onClick:()=>{j(!1),g(null)}}),(0,s.jsx)("div",{className:"absolute inset-0 flex items-center justify-center p-4",children:(0,s.jsxs)("div",{className:"card w-[95vw] max-w-3xl max-h-[85vh] overflow-auto",children:[(0,s.jsxs)("div",{className:"px-4 py-3 card-header flex items-center gap-2",children:[(0,s.jsx)("div",{className:"font-semibold",children:"Editar empleado"}),(0,s.jsx)("button",{className:"ml-auto btn btn-ghost",onClick:()=>{j(!1),g(null)},children:"Cerrar"})]}),(0,s.jsxs)("form",{onSubmit:C,className:"p-4 grid gap-4 sm:grid-cols-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm mb-1",children:"Nombre"}),(0,s.jsx)("input",{className:"w-full input",value:f.nombre||"",onChange:e=>N({...f,nombre:e.target.value}),required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm mb-1",children:"Apellido"}),(0,s.jsx)("input",{className:"w-full input",value:f.apellido||"",onChange:e=>N({...f,apellido:e.target.value}),required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm mb-1",children:"Correo"}),(0,s.jsx)("input",{className:"w-full input",type:"email",value:f.email||"",onChange:e=>N({...f,email:e.target.value})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm mb-1",children:"Tel\xe9fono"}),(0,s.jsx)("input",{className:"w-full input",value:f.telefono||"",onChange:e=>N({...f,telefono:e.target.value})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm mb-1",children:"Empresa"}),(0,s.jsx)("input",{className:"w-full input",value:f.empresa||"",onChange:e=>N({...f,empresa:e.target.value})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm mb-1",children:"Cargo"}),(0,s.jsxs)("select",{className:"w-full input",value:f.cargo||"Tecnico",onChange:e=>N({...f,cargo:e.target.value}),children:[(0,s.jsx)("option",{value:"Supervisor",children:"Supervisor"}),(0,s.jsx)("option",{value:"Tecnico",children:"Tecnico"}),(0,s.jsx)("option",{value:"Contratista",children:"Contratista"})]})]}),(0,s.jsxs)("div",{className:"sm:col-span-2 flex items-center gap-3 pt-2 justify-end",children:[(0,s.jsx)("button",{type:"button",className:"btn",onClick:()=>{j(!1),g(null)},children:"Cancelar"}),(0,s.jsx)("button",{type:"submit",className:"btn btn-primary",children:"Guardar"})]})]})]})})]}),(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"w-full text-sm",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{className:"text-left border-b",children:[(0,s.jsx)("th",{className:"py-2",children:"Nombre"}),(0,s.jsx)("th",{children:"ID"}),(0,s.jsx)("th",{children:"Correo"}),(0,s.jsx)("th",{children:"Tel\xe9fono"}),(0,s.jsx)("th",{children:"Empresa"}),(0,s.jsx)("th",{children:"Cargo"}),(0,s.jsx)("th",{})]})}),(0,s.jsx)("tbody",{children:l.map(e=>(0,s.jsxs)("tr",{className:"border-b",children:[(0,s.jsx)("td",{className:"py-2",children:(0,s.jsxs)("span",{children:[e.nombre," ",e.apellido]})}),(0,s.jsx)("td",{className:"whitespace-nowrap",children:(0,s.jsx)("div",{className:"flex items-center gap-2",title:String(e.id||e._id),children:(0,s.jsx)("code",{className:"text-xs font-mono text-neutral-700 bg-neutral-100 px-1.5 py-0.5 rounded",children:e.shortId||function(e){let a=String(e||""),l=0;for(let e=0;e<a.length;e++)l=31*l+a.charCodeAt(e)>>>0;return String(100+l%900)}(e.id||e._id)})})}),(0,s.jsx)("td",{children:e.email||"—"}),(0,s.jsx)("td",{children:e.telefono||"—"}),(0,s.jsx)("td",{children:e.empresa||e.congregacion||"—"}),(0,s.jsx)("td",{children:e.cargo||"—"}),(0,s.jsxs)("td",{className:"text-right whitespace-nowrap py-2",children:[(0,s.jsx)("button",{className:"p-1 mr-2 border rounded inline-flex items-center justify-center hover:bg-muted",onClick:()=>y(e),title:"Editar","aria-label":"Editar",children:(0,s.jsx)(i,{className:"h-5 w-5"})}),(0,s.jsx)("button",{className:"p-1 border rounded inline-flex items-center justify-center hover:bg-red-50 text-red-600",onClick:()=>k(e.id),title:"Eliminar","aria-label":"Eliminar",children:(0,s.jsx)(o,{className:"h-5 w-5"})})]})]},e.id||e._id))})]})})]})}},4078:(e,a,l)=>{Promise.resolve().then(l.bind(l,217))}},e=>{e.O(0,[1026,2619,8441,1255,7358],()=>e(e.s=4078)),_N_E=e.O()}]);